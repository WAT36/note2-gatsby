{"componentChunkName":"component---src-templates-note-js","path":"/programming/012_machine_learning/001_supervised_learning/101_regression/mse/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"d97b0aa9-47bb-5563-80a6-73ff7c780d5c","excerpt":"前述の直線モデルにて、データに応じた最適なw0,w1を決めれば最適な関係式が得られると書いたが、\nどのようにして最適なw0,w1を求めれば良いのか？ 関係式が最適になるようにするには、入力値に対する実際の結果と関係式による出力結果との差（誤差）が小さくなるようにすればよい。 前述に倣い、入力をxi、実際の結果をti…","html":"<p>前述の直線モデルにて、データに応じた最適なw<sub>0</sub>,w<sub>1</sub>を決めれば最適な関係式が得られると書いたが、\nどのようにして最適なw<sub>0</sub>,w<sub>1</sub>を求めれば良いのか？</p>\n<p>関係式が最適になるようにするには、入力値に対する実際の結果と関係式による出力結果との差（誤差）が小さくなるようにすればよい。</p>\n<p>前述に倣い、入力をx<sub>i</sub>、実際の結果をt<sub>i</sub>、関係式による出力結果をy<sub>i</sub> (= w<sub>0</sub> x<sub>i</sub> + w<sub>1</sub> )(i = 1,2,・・・,n)  とすると、それぞれの誤差は</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"normal\">∣</mi><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">| y_{i} - t_{i} |</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span></span></div>\n<p>となる。<br>\nこのままやってもよいのだが、計算の簡略化<sup id=\"fnref-1\"><a href=\"#fn-1\" class=\"footnote-ref\">1</a></sup>のために、この誤差の2乗をとり、さらに全てのiにおける平均を取ると以下のような値になる。</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>N</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{N} \\sum_{i=0}^N (  y_{i} - t_{i} )^2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.106em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">0</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></div>\n<p>この値を<strong>平均二乗誤差</strong>(mean square error)といい、この値がなるべく小さくなるようなw<sub>0</sub>,w<sub>1</sub>を求めることを考える。</p>\n<p>以下、w,x,tを入力とし、平均二乗誤差を算出するコードを記載する。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">mse</span><span class=\"token punctuation\">(</span>w<span class=\"token punctuation\">,</span>x<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    y <span class=\"token operator\">=</span> w<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>x <span class=\"token operator\">+</span> w<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>            <span class=\"token comment\"># 理論値</span>\n    mse <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>mean<span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">-</span> t<span class=\"token punctuation\">)</span><span class=\"token operator\">**</span><span class=\"token number\">2</span> <span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 平均二乗誤差を算出</span>\n    <span class=\"token keyword\">return</span> mse </code></pre></div>\n<p>この関数mseにおいて、求めたいのは出力mseが最も小さくなるようなw[0],w[1]の組み合わせである。<br>\nそのため、指定したw0,w1の範囲でmseを算出し、mseをw0,w1のグラフとして可視化させ、どこで一番小さくなるかを確認してみよう。<br>\nとりあえず、w0,w1を-30~30の範囲で絞り、mseを算出してみる。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token comment\">#入力値</span>\nx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">167.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">164.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">171.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">162.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">170.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">163.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">168.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">167.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">166.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">173.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">176.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">178.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">167.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">177.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">173.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">174.1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#実測値</span>\nt  <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">58.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">58.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">65.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">55.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">61.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">56.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">62.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">57.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">64.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">55.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">68.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">67.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">69.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">65.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">66.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">59.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">69.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#w0,w1を-30~30の組み合わせでそれぞれ指定してmse算出</span>\nw0 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\nw1 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#平均二乗誤差J,全てのw0,w1の組み合わせで算出</span>\nJ <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>zeros<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>w0<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>w1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">for</span> i0 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">for</span> i1 <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>    \n            J<span class=\"token punctuation\">[</span>i1<span class=\"token punctuation\">,</span>i0<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>mse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>w0<span class=\"token punctuation\">[</span>i0<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>w1<span class=\"token punctuation\">[</span>i1<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>x<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>次に、算出したmseをグラフ(3次元と等高線)で可視化させる。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> mpl_toolkits<span class=\"token punctuation\">.</span>mplot3d <span class=\"token keyword\">import</span> Axes3D\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\">#グラフの表示サイズ</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#２グラフの間隔を調整</span>\nplt<span class=\"token punctuation\">.</span>subplots_adjust<span class=\"token punctuation\">(</span>wspace<span class=\"token operator\">=</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#subplot,1*2の1つ目に表示するグラフ作成</span>\nax <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>projection<span class=\"token operator\">=</span><span class=\"token string\">'3d'</span><span class=\"token punctuation\">)</span>\n\nww0<span class=\"token punctuation\">,</span>ww1 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>meshgrid<span class=\"token punctuation\">(</span>w0<span class=\"token punctuation\">,</span>w1<span class=\"token punctuation\">)</span>\n\nax<span class=\"token punctuation\">.</span>plot_surface<span class=\"token punctuation\">(</span>ww0<span class=\"token punctuation\">,</span>ww1<span class=\"token punctuation\">,</span>J<span class=\"token punctuation\">,</span>rstride<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>cstride<span class=\"token operator\">=</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span>alpha<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span><span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span>edgecolor<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">)</span>\n\nax<span class=\"token punctuation\">.</span>set_xticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\nax<span class=\"token punctuation\">.</span>set_yticks<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">60</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\nax<span class=\"token punctuation\">.</span>set_xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">'w0'</span><span class=\"token punctuation\">)</span>\nax<span class=\"token punctuation\">.</span>set_ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'w1'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#等高線グラフ</span>\nplt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\ncont <span class=\"token operator\">=</span> plt<span class=\"token punctuation\">.</span>contour<span class=\"token punctuation\">(</span>ww0<span class=\"token punctuation\">,</span>ww1<span class=\"token punctuation\">,</span>J<span class=\"token punctuation\">,</span><span class=\"token number\">30</span><span class=\"token punctuation\">,</span>colors<span class=\"token operator\">=</span><span class=\"token string\">'black'</span><span class=\"token punctuation\">,</span>levels<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">100000</span><span class=\"token punctuation\">,</span><span class=\"token number\">1000000</span><span class=\"token punctuation\">,</span><span class=\"token number\">10000000</span><span class=\"token punctuation\">,</span><span class=\"token number\">100000000</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\ncont<span class=\"token punctuation\">.</span>clabel<span class=\"token punctuation\">(</span>fmt<span class=\"token operator\">=</span><span class=\"token string\">'%1.0f'</span><span class=\"token punctuation\">,</span>fontsize<span class=\"token operator\">=</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>xlabel<span class=\"token punctuation\">(</span><span class=\"token string\">'w0'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylabel<span class=\"token punctuation\">(</span><span class=\"token string\">'w1'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行結果</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/d61c2/Figure_18.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 44.30379746835443%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAB7CAAAewgFu0HU+AAABUklEQVQoz3VSwWrCQBD1tz169Qs8SaEXiyBeehGkUIuX6qG0IhJIokaDm93omkRNGvPKTNlgJR0YFubNvn3zZmtFUYCSwpwm7rE8z3G9XivT9NVuL1Pk+TfO5zM33WNRFEEphTiO4bouPM/jWhiG/BgT3qrQOkK/P8JsZiFJNIRQkFIhyzLGiWi/3+NyucBxHKzXayRJAq11KeAP4Xj8iUbjEdPpF+ZzD4PBB5QSME6cTiccDgcmtG0bm82Ga/8QFlgsXDSbT+h2X9BqvWEyWUDrkBuJJE3TknC1WnGSPRWE4MJuF6Ddfka9/oBOZwQhfGy3W24k3IxMqmhc8rFS4a/hMaQUGA7f0eu9IgwlKwiCoFwM+UWEpMosxdhQQRhBCAHf9xEEgpuXy2XZaAhpo3QSRiqN6nLL9/+PXqQLlmXxeYsfj0cmpBFJuZSSa6TQ/IQfED2txYGRvp4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 18\"\n        title=\"Figure 18\"\n        src=\"/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/f058b/Figure_18.png\"\n        srcset=\"/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/c26ae/Figure_18.png 158w,\n/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/6bdcf/Figure_18.png 315w,\n/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/f058b/Figure_18.png 630w,\n/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/40601/Figure_18.png 945w,\n/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/78612/Figure_18.png 1260w,\n/note2-gatsby/static/7be136db9e1f1b010e378446b297542f/d61c2/Figure_18.png 1800w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>グラフによると、w<sub>0</sub> = 0のあたりで平均二乗誤差Jが最低となり、最適になるように思えるが、もう少し厳密な値を調べてみたい。<br>\nそこでこのグラフを用いてJが最小となるw<sub>0</sub>、w<sub>1</sub>の組み合わせを次章で求めてみる。</p>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-1\">誤差の二乗を取る理由は諸説あるが、ほとんどはこの理由（らしい）。<a href=\"#fnref-1\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","frontmatter":{"title":"平均二乗誤差","date":"October 26, 2019","description":"","tags":[]}}},"pageContext":{"id":"d97b0aa9-47bb-5563-80a6-73ff7c780d5c"}},"staticQueryHashes":["2841359383","3257411868"]}