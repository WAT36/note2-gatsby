{"componentChunkName":"component---src-templates-note-js","path":"/programming/012_machine_learning/001_supervised_learning/101_regression/linear_model/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"27e1d5b8-cdb2-5a20-98bb-c85ecb61e715","excerpt":"回帰問題の手法の一つである直線モデルについて。 教師あり学習 で与えられた入力と結果から関係式を算出すると言うことを述べたが、\n必ずしも100%正確な式を算出すると言うことでは無いことを念頭においてほしい。（と言うよりどのような入力に対して10…","html":"<p>回帰問題の手法の一つである直線モデルについて。</p>\n<p>教師あり学習 で与えられた入力と結果から関係式を算出すると言うことを述べたが、\n必ずしも100%正確な式を算出すると言うことでは無いことを念頭においてほしい。（と言うよりどのような入力に対して100%正解と言えるような値を算出することは不可能である。勿論算出する式は正確性を高くする事を目標に算出するが）</p>\n<p>関係式は、現入力データに対して最も誤差が少ないような結果を出力するような式を算出すると言うやり方で考える。</p>\n<p>その関係式だが、基本となる数式を元に算出を行う。この基本となる数式を<strong>モデル</strong>と呼ぶ。</p>\n<p>今回は例として、以下の身長と体重からなるデータを用意する。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">身長</th>\n<th align=\"left\">体重</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">167.9</td>\n<td align=\"left\">58.0</td>\n</tr>\n<tr>\n<td align=\"left\">164.3</td>\n<td align=\"left\">58.2</td>\n</tr>\n<tr>\n<td align=\"left\">171.6</td>\n<td align=\"left\">60.1</td>\n</tr>\n<tr>\n<td align=\"left\">172.7</td>\n<td align=\"left\">65.2</td>\n</tr>\n<tr>\n<td align=\"left\">162.8</td>\n<td align=\"left\">55.0</td>\n</tr>\n<tr>\n<td align=\"left\">170.2</td>\n<td align=\"left\">60.9</td>\n</tr>\n<tr>\n<td align=\"left\">172.3</td>\n<td align=\"left\">61.9</td>\n</tr>\n<tr>\n<td align=\"left\">163.8</td>\n<td align=\"left\">56.4</td>\n</tr>\n<tr>\n<td align=\"left\">168.8</td>\n<td align=\"left\">62.9</td>\n</tr>\n<tr>\n<td align=\"left\">167.2</td>\n<td align=\"left\">57.0</td>\n</tr>\n<tr>\n<td align=\"left\">172.3</td>\n<td align=\"left\">64.9</td>\n</tr>\n<tr>\n<td align=\"left\">166.4</td>\n<td align=\"left\">55.9</td>\n</tr>\n<tr>\n<td align=\"left\">173.1</td>\n<td align=\"left\">68.0</td>\n</tr>\n<tr>\n<td align=\"left\">176.9</td>\n<td align=\"left\">67.9</td>\n</tr>\n<tr>\n<td align=\"left\">178.4</td>\n<td align=\"left\">69.1</td>\n</tr>\n<tr>\n<td align=\"left\">167.1</td>\n<td align=\"left\">60.8</td>\n</tr>\n<tr>\n<td align=\"left\">177.4</td>\n<td align=\"left\">65.6</td>\n</tr>\n<tr>\n<td align=\"left\">173.7</td>\n<td align=\"left\">66.1</td>\n</tr>\n<tr>\n<td align=\"left\">172.0</td>\n<td align=\"left\">59.9</td>\n</tr>\n<tr>\n<td align=\"left\">174.1</td>\n<td align=\"left\">69.5</td>\n</tr>\n</tbody>\n</table>\n<p>プロットすると以下のような図になる。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/21b4d/Figure_16.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAB7CAAAewgFu0HU+AAABfUlEQVQ4y61T2Y7CMAzk/3+RN0AUQQ8ouVNnVmOa7nIsSKutVLlJ7MnM2F2VUvBfD7FW/AghYBxHeO/hnPvTKyIKqoBcGGOQc0ZKCdM0vY3yY80aEokxfgNyk4AEZhKpv4tpuuWhFK0h2B0gJZ/P54/MikwYrUdvPHJOiCmjGx2MdUgp3kuuPnxieLw4jC4BRTDYCBeSgt0xpNy+7xcmtCDOzJgYIn3LGF1A01+VWU4J1kdYH1ThAljHhptl9qTMrKUUuJhx8QQXZCmwIWn+NHeVNSTxlqFo9xKu7saA+/Rq1xn1kOdxVsL8py6zwFqrtxYR9CaoTD7t6JDYURF4Ss158bR6/tRl3nI1BqUIjI9or0ELGQlIAK7xAPQrYB0bSqGkPEun+ZLz23F6Odi8iZs6GmzGMj7yktFjrJOxAPI/Xq/X6LoO2+1WG7TZbDTudjsMw6CR503ToG1bHA4HnE4nHI9H7Pd7PVsA6+/HG2vUbs/r6uEjs/rNs8rwCxpbmM2k1jUqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 16\"\n        title=\"Figure 16\"\n        src=\"/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/f058b/Figure_16.png\"\n        srcset=\"/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/c26ae/Figure_16.png 158w,\n/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/6bdcf/Figure_16.png 315w,\n/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/f058b/Figure_16.png 630w,\n/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/40601/Figure_16.png 945w,\n/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/78612/Figure_16.png 1260w,\n/note2-gatsby/static/064a799c5d6bc0831abf964ac7d9aa46/21b4d/Figure_16.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>今回は基本となる数式として直線の式(<strong>直線モデル</strong>)を利用して予測を行ってみる。</p>\n<p>このデータに対して、なんとなくだが、以下のような直線を引くとそれらしい予測を行えそうである。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/21b4d/Figure_17.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAB7CAAAewgFu0HU+AAABqElEQVQ4y62TjW7jIBCE+/6veKp0SnJ2ggE72GtYfjzVkpC0aZOTTmfJWhDwMTu7vG3bhv/1CetNBiEEOOfgvce6rv/0l1IqtAJlsiwLUkqIMSLn/DKWNk8JKUZ4ZjDzHSggAQpYDon0VzGmXGMVs21g58Ah3IGS8jRNf1W2lQxHHpYCUsngZcF534FOCjHy15SbD0+VpQQpn5rFbwKMwdwr+NUj5vQ1ZUnXWntTIhbwVZlsDDGhbAVuJvS//4BPCokICycsgRG8vwNb20jaMhaV21W1+LOmgjMx8jgiDRp0nuv+fD0nZ0TEc4XMtYri0bwG0GCQlYI5GRwswfnLugBaV/jPCuttOYOILn5hgyVGGCfAGuheI+aLas+pQpq3zXN+bBu5ZSaqh2hyMLsOyY7QzkMTV4CA8AB6CgzMmLRGGQYsJ4UcI6JslGKk140uF31LWcz30ofeXwoixantUn5U9BhbZ9yA8o5/vb/DWIv9fl8LtNvtajwcDhjHsUZjDPq+h9Yax+MRwzBAKYWu6+raDVifn7zRUupNEuOnefPwUVkby1pT+AFMOZagVbr46AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 17\"\n        title=\"Figure 17\"\n        src=\"/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/f058b/Figure_17.png\"\n        srcset=\"/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/c26ae/Figure_17.png 158w,\n/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/6bdcf/Figure_17.png 315w,\n/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/f058b/Figure_17.png 630w,\n/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/40601/Figure_17.png 945w,\n/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/78612/Figure_17.png 1260w,\n/note2-gatsby/static/2247db0c408bc9c1fec615d2bd97e1fb/21b4d/Figure_17.png 1280w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>直線の式は以下の式のように表すことができる。</p>\n<div class=\"math math-display\"><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mi>x</mi><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">y(x) = w_{0} x + w_{1}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">0</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></div>\n<p>最適な直線モデルの式を求めるには、最適なw<sub>0</sub>とw<sub>1</sub>を求めれば良いのだが、どのように求めれば良いのか？</p>\n<p>そちらは次章で記載する。</p>\n<p>&#x3C;参考>グラフのコード</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> x <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">167.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">164.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">171.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">162.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">170.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">163.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">168.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">167.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.3</span><span class=\"token punctuation\">,</span><span class=\"token number\">166.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">173.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">176.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">178.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">167.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">177.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">173.7</span><span class=\"token punctuation\">,</span><span class=\"token number\">172.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">174.1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">58.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">58.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">65.2</span><span class=\"token punctuation\">,</span><span class=\"token number\">55.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">61.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">56.4</span><span class=\"token punctuation\">,</span><span class=\"token number\">62.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">57.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">64.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">55.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">68.0</span><span class=\"token punctuation\">,</span><span class=\"token number\">67.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">69.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">60.8</span><span class=\"token punctuation\">,</span><span class=\"token number\">65.6</span><span class=\"token punctuation\">,</span><span class=\"token number\">66.1</span><span class=\"token punctuation\">,</span><span class=\"token number\">59.9</span><span class=\"token punctuation\">,</span><span class=\"token number\">69.5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span>y<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">&lt;</span>matplotlib<span class=\"token punctuation\">.</span>collections<span class=\"token punctuation\">.</span>PathCollection <span class=\"token builtin\">object</span> at <span class=\"token number\">0x11d2fcef0</span><span class=\"token operator\">></span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>xlim<span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">,</span><span class=\"token number\">180</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span><span class=\"token number\">160</span><span class=\"token punctuation\">,</span> <span class=\"token number\">180</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span><span class=\"token number\">75</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span><span class=\"token number\">50</span><span class=\"token punctuation\">,</span> <span class=\"token number\">75</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> </code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token comment\">#↑でplt.gridまで行う</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> <span class=\"token keyword\">def</span> <span class=\"token function\">f</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>     <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token number\">0.9038</span> <span class=\"token operator\">*</span> x<span class=\"token punctuation\">)</span> <span class=\"token operator\">-</span> <span class=\"token number\">92.1461</span>\n<span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> x2 <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>array<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">100</span><span class=\"token punctuation\">,</span><span class=\"token number\">200</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> y2 <span class=\"token operator\">=</span> f<span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x2<span class=\"token punctuation\">,</span>y2<span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span><span class=\"token string\">'red'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">[</span><span class=\"token operator\">&lt;</span>matplotlib<span class=\"token punctuation\">.</span>lines<span class=\"token punctuation\">.</span>Line2D <span class=\"token builtin\">object</span> at <span class=\"token number\">0x120b47ba8</span><span class=\"token operator\">></span><span class=\"token punctuation\">]</span>\n<span class=\"token operator\">>></span><span class=\"token operator\">></span> \n<span class=\"token operator\">>></span><span class=\"token operator\">></span> plt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"直線モデル(線形回帰)","date":"October 26, 2019","description":"","tags":[]}}},"pageContext":{"id":"27e1d5b8-cdb2-5a20-98bb-c85ecb61e715"}},"staticQueryHashes":["2841359383","3257411868"]}