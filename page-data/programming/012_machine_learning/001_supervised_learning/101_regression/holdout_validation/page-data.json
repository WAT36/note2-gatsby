{"componentChunkName":"component---src-templates-note-js","path":"/programming/012_machine_learning/001_supervised_learning/101_regression/holdout_validation/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"c397bc06-9dcd-545a-a8d1-da934efcd8a0","excerpt":"先述のオーバーフィッティング(過学習)の章で、Mを大きくすればするほど既存の入力データに対する精度が高くなり、未知の入力に対する予測精度が悪くなるという問題があった。最適なM…","html":"<p>先述のオーバーフィッティング(過学習)の章で、Mを大きくすればするほど既存の入力データに対する精度が高くなり、未知の入力に対する予測精度が悪くなるという問題があった。最適なMはどう求めれば良いのだろうか？</p>\n<p>その一つの方法として、<strong>ホールドアウト検証</strong>という手法を挙げる。</p>\n<p>これは、今ある入力データをいくつかの集合に分割し、そのうちのいくつかを学習に使って予測式を作り、残りのデータでその予測式を使った結果の平均二乗誤差(または標準偏差SD)を算出することでMの評価基準とする、という方法である。</p>\n<p>ここで、予測式を作るための学習に使うデータのことを <strong>訓練データ (training data)</strong> といい、作成した予測式の評価に用いるデータを <strong>テストデータ (test data)</strong> と呼ぶ。</p>\n<p>では試しに、先述の線形基底関数モデルで利用したデータ(=直線モデル(線形回帰)で利用したデータ)を４分割し、初めの4分の３を訓練データとして学習させ、残りの4分の１をテストデータとして利用し、各Mの評価を行ってみよう。</p>\n<p>コードを以下に記載する。(holdout_validation.py)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> mse\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> design_matrix\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> linear_basis_func\n\n<span class=\"token comment\">#入力値</span>\nx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'x.npy'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#実測値</span>\nt <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'t.npy'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#mを設定</span>\nM<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">13</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#訓練データ,全体の3/4</span>\nn<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">3</span>\nx_train<span class=\"token operator\">=</span>x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span>\nt_train<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#テストデータ</span>\nx_test<span class=\"token operator\">=</span>x<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\nt_test<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#メイン(プロット)</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">20</span><span class=\"token punctuation\">,</span><span class=\"token number\">7.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>subplots_adjust<span class=\"token punctuation\">(</span>wspace<span class=\"token operator\">=</span><span class=\"token number\">0.25</span><span class=\"token punctuation\">,</span>hspace<span class=\"token operator\">=</span><span class=\"token number\">0.3</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    m<span class=\"token operator\">=</span>M<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\">#ガウス関数の中心 はxの最小値〜最大値の間で設定</span>\n    mu<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#訓練データでw,y算出</span>\n    w_train <span class=\"token operator\">=</span> design_matrix<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span>t_train<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    y_test <span class=\"token operator\">=</span> linear_basis_func<span class=\"token punctuation\">(</span>w_train<span class=\"token punctuation\">,</span>x_test<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#標準偏差SD算出</span>\n    sd <span class=\"token operator\">=</span> math<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>mse<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span>t_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#予測式を細かく表示させるためのデータ作成</span>\n    x_forplot <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span>\n    y_forplot <span class=\"token operator\">=</span> linear_basis_func<span class=\"token punctuation\">(</span>w_train<span class=\"token punctuation\">,</span>x_forplot<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#プロット</span>\n    plt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span>t_train<span class=\"token punctuation\">,</span>c<span class=\"token operator\">=</span><span class=\"token string\">'white'</span><span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'train'</span><span class=\"token punctuation\">,</span>edgecolors<span class=\"token operator\">=</span><span class=\"token string\">\"black\"</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>scatter<span class=\"token punctuation\">(</span>x_test<span class=\"token punctuation\">,</span>t_test<span class=\"token punctuation\">,</span>c<span class=\"token operator\">=</span><span class=\"token string\">'green'</span><span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'test'</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>xlim<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>t<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\n\n    plt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>x_forplot<span class=\"token punctuation\">,</span>y_forplot<span class=\"token punctuation\">,</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span><span class=\"token string\">'red'</span><span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'y_train'</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'lower right'</span><span class=\"token punctuation\">)</span>\n    plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"M={0:d}, SD={1:.2f}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">,</span>sd<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    plt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行結果</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/f21a2/Figure_23.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.43037974683544%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAB7CAAAewgFu0HU+AAABxElEQVQoz1VS2XLjMAzz//9lm20qy7Lu+zA6pJPM7INGEgVSIMCt1opSClpr8N5j33ccxwGKv9/mnLiui88UI6zWGkII3ltKH/wWY8Qcg5PWWrgAXuN1r7Xx2xgDKSWOEf6D7R3jPLH6uAuGEDh50ENtGK2hpATrNWrN8N5xcu8d/PlajO9EYl0I54HoNArvFlsgUCno3qJYjWYtnBTowWNoDSslF+mtIaaEq1TUklGsQdEaTkms60L1Ds47bNYY2OcTzjnY4FFqRaKEWqG0wq8Qd8tz4pQSft8ZH/SJHCNyzrzE/gulFLaSM2tDQTKFgsYYvlOcjCBDiEWKEYkKpAxtDE5iaC1jiT2Ztb0dJo3oTEVJhq41OhXs/WMYJb6xpKcPAdEY9JTRY+SublNI4LfTABYV1wrTexRrbw1fRdacH5cJO3NGCQ4zRCZ0j818OdcaBmmoFEKwaDnBW421rv/Gps/JszdKZQNLSWxoPBW24D231kpGPg92ORrFrHIMPOTEnBmGcDNKgTtoSiE6wxo7uUNLiU1JCfn9DfV4QJGDzsFYC2sthPzFLgSzIobi5wfn44Hj6wvnyzz7wj6f/3AeB/4ApBVSoqVRQL0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 23\"\n        title=\"Figure 23\"\n        src=\"/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/f058b/Figure_23.png\"\n        srcset=\"/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/c26ae/Figure_23.png 158w,\n/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/6bdcf/Figure_23.png 315w,\n/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/f058b/Figure_23.png 630w,\n/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/40601/Figure_23.png 945w,\n/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/78612/Figure_23.png 1260w,\n/note2-gatsby/static/88acdcda6a94d1fdd32fa80a4c4f2f38/f21a2/Figure_23.png 2327w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>となり、Mが高くなるほど訓練データへの誤差は少なくなるが、テストデータへの誤差（標準偏差）は大きくなる。</p>\n<p>この場合で最適なMを調べるために、各Mにおいて訓練データとテストデータの誤差(標準偏差)を調べてみよう。</p>\n<p>各Mにおいて訓練データとテストデータの誤差(標準偏差)を算出し、グラフを作成するコードを以下に記載する。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> math\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> mse\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> design_matrix\n<span class=\"token keyword\">from</span> linear_basis_function <span class=\"token keyword\">import</span> linear_basis_func\n\n<span class=\"token comment\">#入力値</span>\nx <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'x.npy'</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">#実測値</span>\nt <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">'t.npy'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#訓練データ,全体の3/4</span>\nn<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span><span class=\"token operator\">//</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span><span class=\"token operator\">*</span><span class=\"token number\">3</span>\nx_train<span class=\"token operator\">=</span>x<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span>\nt_train<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span>n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#テストデータ</span>\nx_test<span class=\"token operator\">=</span>x<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\nt_test<span class=\"token operator\">=</span>t<span class=\"token punctuation\">[</span>n<span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#M毎の標準偏差SD</span>\nsd_train<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\nsd_test<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#メイン(プロット)</span>\nplt<span class=\"token punctuation\">.</span>figure<span class=\"token punctuation\">(</span>figsize<span class=\"token operator\">=</span><span class=\"token punctuation\">(</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">7.5</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\nM<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>i <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">14</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">for</span> m <span class=\"token keyword\">in</span> M<span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\">#ガウス関数の中心 はxの最小値〜最大値の間で設定</span>\n    mu<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>linspace<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>m<span class=\"token punctuation\">)</span>\n    <span class=\"token comment\">#訓練データでw,y算出</span>\n    w_train <span class=\"token operator\">=</span> design_matrix<span class=\"token punctuation\">(</span>x_train<span class=\"token punctuation\">,</span>t_train<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    y_test <span class=\"token operator\">=</span> linear_basis_func<span class=\"token punctuation\">(</span>w_train<span class=\"token punctuation\">,</span>x_test<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n    y_train <span class=\"token operator\">=</span> linear_basis_func<span class=\"token punctuation\">(</span>w_train<span class=\"token punctuation\">,</span>x_train<span class=\"token punctuation\">,</span>mu<span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">#標準偏差SD算出</span>\n    sd_train<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>mse<span class=\"token punctuation\">(</span>y_train<span class=\"token punctuation\">,</span>t_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    sd_test<span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>math<span class=\"token punctuation\">.</span>sqrt<span class=\"token punctuation\">(</span>mse<span class=\"token punctuation\">(</span>y_test<span class=\"token punctuation\">,</span>t_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#プロット</span>\nplt<span class=\"token punctuation\">.</span>xlim<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>ylim<span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>sd_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>sd_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>sd_train<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">max</span><span class=\"token punctuation\">(</span>sd_test<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span>sd_train<span class=\"token punctuation\">,</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span><span class=\"token string\">'blue'</span><span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'SD_train'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>plot<span class=\"token punctuation\">(</span>M<span class=\"token punctuation\">,</span>sd_test<span class=\"token punctuation\">,</span><span class=\"token string\">'-'</span><span class=\"token punctuation\">,</span>color<span class=\"token operator\">=</span><span class=\"token string\">'red'</span><span class=\"token punctuation\">,</span>label<span class=\"token operator\">=</span><span class=\"token string\">'SD_test'</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>legend<span class=\"token punctuation\">(</span>loc<span class=\"token operator\">=</span><span class=\"token string\">'higher left'</span><span class=\"token punctuation\">)</span>\n\nplt<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span>\nplt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行結果</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/cea38/Figure_24.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAB7CAAAewgFu0HU+AAABuklEQVQ4y42Ti46cMAxF+f/PHKmq2AES5/1ybuVAZpmuWg0S5MaO7GM7LOpQ2J8Gj8cD27YhxgjvPZxzCCGMVfZ3ffd7reGtffmX4D0SWazrOg7K03sHMw89139p3nd0pYYWmMVai8ZtGFpr46CstdahZZ32qYe/FEjIqhTa84nOPCgXweRboEkn+p5E7NM/9fAbAyYCUkJMCYtgzoP/Czj1j4BE4FKAWs+ASpBnGVeZH5UstlLOkq8ko+SU0hvhHMqdUPY/CIVaEgjhNagxFK31K3ORRn9KKP6cT0Lp8RzKDHK/Cn9fm0n4ujbiF5skIkL/iPDSsr4IL91qPXvoHKr374TyYW4jy3BcJG89FLKrb+KfZ2EMWs4n7SSUv0MIe8ngHIEqB85+sQ+Duo0SgRoi2qHQnEeRxGRQYkRt/D1licqN4b486BfB/rYIK6FsCvAOXSsgeCA4dNIAV8ASOinAaPRWL+aLUD5CUSoj5oZSOyxlHFuCtoA6CvTqoFcPRQwtr25QWwSpCqXq2OfMiDGcQ5GyYwgwhpBSHA7R3iUcB8HYABcy9l3DGA8ih6/ngXDZjsMgJdE7/gB0wpfAPezf6AAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Figure 24\"\n        title=\"Figure 24\"\n        src=\"/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/f058b/Figure_24.png\"\n        srcset=\"/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/c26ae/Figure_24.png 158w,\n/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/6bdcf/Figure_24.png 315w,\n/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/f058b/Figure_24.png 630w,\n/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/40601/Figure_24.png 945w,\n/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/78612/Figure_24.png 1260w,\n/note2-gatsby/static/2f2f40d037e3c4e1832ddc9fce9e8f5a/cea38/Figure_24.png 1644w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>のようになり、この図よりテストデータに対して誤差が最も低くなるM=7,10あたりが最も適切なMであると推測できる。</p>\n<p>よって、このホールドアウト検証で最適なMが決定できた。</p>\n<p>しかし、今回はテストデータが分散しているため良いが、例えばテストデータがひとかたまりになる場合（テストデータを低い順または高い順から取ってくるなど）すると、また学習結果も悪くなるのは予想できると思う。つまり、実はホールドアウト検証はどれを訓練データ及びテストデータに選ぶかによって結果が変わってくるものなのである。</p>\n<p>そこで、もう一つの検証方法についてを次章で述べる。</p>","frontmatter":{"title":"ホールドアウト検証","date":"October 26, 2019","description":"","tags":[]}}},"pageContext":{"id":"c397bc06-9dcd-545a-a8d1-da934efcd8a0"}},"staticQueryHashes":["2841359383","3257411868"]}