{"componentChunkName":"component---src-templates-note-js","path":"/programming/013_procon/003_graph/minimum_spanning_tree/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"984400b7-d43d-5e15-b378-656efcc3aee5","excerpt":"無向グラフが与えられたときに、その内のある辺だけを用いてグラフ中の任意の２頂点を連結(ある頂点から他のどの頂点への経路が存在する)にした木のことを 全域木(Spanning Tree) という。 辺にコストがあったときに、使われる辺のコストの和を最小にした全域木のことを 最小全域木(Minimum Spanning…","html":"<p>無向グラフが与えられたときに、その内のある辺だけを用いてグラフ中の任意の２頂点を連結(ある頂点から他のどの頂点への経路が存在する)にした木のことを <strong>全域木(Spanning Tree)</strong> という。</p>\n<p>辺にコストがあったときに、使われる辺のコストの和を最小にした全域木のことを <strong>最小全域木(Minimum Spanning Tree)</strong> という。</p>\n<p>例えばベルマンフォード・ダイクストラ法で用いたグラフの最小全域木は以下のように表される。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/1628f/spanning_tree1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 33.54430379746836%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsTAAALEwEAmpwYAAAA3ElEQVQoz22RaQqFMAyEez1P5g08kufwnwvivqPm8Q1E5OFAaNomM5M23Pdt4DxPy7LMfA/IvwIURWFN0zx1vgaSfd/tOA6tfd/bPM+2bZt9AeFlWdQ8TZP6yK/r0n1gAwmFdV0/ZFVV2TiOEoGARoI7iDinhjMnK8vSAgXDMKgoz3M1d12nkSigIYoiS5JETtZ1VTM9bduKjOBOhBRA9n5L1CHHLYjj2NI0Ve6ugTujH7fsNTKOcEpQjLo7+QcTQIAY7skRwcjzhq7CmBC9f80f3MdyMAHC7tZ/+QcvjR5BfnIkGgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"全域木例1\"\n        title=\"全域木例1\"\n        src=\"/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/f058b/spanning_tree1.png\"\n        srcset=\"/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/c26ae/spanning_tree1.png 158w,\n/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/6bdcf/spanning_tree1.png 315w,\n/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/f058b/spanning_tree1.png 630w,\n/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/40601/spanning_tree1.png 945w,\n/note2-gatsby/static/5b48338b6927a91d0a2acbac1ed4422b/1628f/spanning_tree1.png 1232w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>最小全域木を求めるアルゴリズムとして、一般に<strong>プリム法</strong>と<strong>クラスカル法</strong>の2つが知られている。</p>\n<h2>プリム法</h2>\n<p>プリム法は、グラフのある頂点から辺を付け足して行って最小全域木を求めていく手法である。</p>\n<p>始め、1つの頂点vからなるグラフTを考えたとき、ここからグラフTとその他の頂点を結ぶ最小コストの辺をグラフTに追加していく、と言う操作を繰り返すことにより、最小全域木が作成できる。</p>\n<p>プリム法のアルゴリズムは以下の通り。</p>\n<p>入出力：</p>\n<ul>\n<li>入力</li>\n<li>グラフ G = (V,E)</li>\n<li>W(a,b):頂点aから頂点b(a,b∈V)を結ぶ辺の重み(コスト)。辺が存在しないときはW(a,b)=∞</li>\n<li>頂点s (s∈V)</li>\n<li>出力</li>\n<li>最小全域木 X = (V’,E’)</li>\n</ul>\n<p>アルゴリズム：</p>\n<ol>\n<li>X=a (a∈V)、Y=V-X とする。aは何でも良い。</li>\n<li>頂点x (x∈X) 、頂点y (y∈Y)を結ぶ辺で、Xに追加したときに閉路をなさない辺のうち、最小のコストを持つ辺eを探す。</li>\n<li>X=X+(eのY側の要素)、Y=Y-(eのY側の要素)とする。</li>\n<li>Y={} (|Y|=0) ならば、Xを出力して終了する。そうでない時は、2.に戻る。</li>\n</ol>\n<p>例として、以下のグラフに対しプリム法を適用した場合を追って説明する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 309px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQ4y32UWY/CMAyE8/9/FUJ944EXhMoNKvdZzrbi8Oqz5ChbWixFmzTe8czYwUlFfD4feb/fuo+iSOI49t9Z5X0YLgQJE+282+1kPp/L7XaTPM8rc8NvrsysHKfTSdI01f1yuZTn8/mVG+5dmREsHo+HvF4vZbbf7xVwu93K9XqVJEnkcrn4YmaNYXhAu7jf79LpdJQNeyLLMun3+57dZrNR4G63+80wlGesYBMGwKPRyHtIoIKix+NRz6vVSv12zWZTJbCoWhSFsgWcGA6HMhgM9K5cHOZYcjgcpN1uy2QyEUciVfAHZgAiZTweK6PZbKZg7PlHCpPLKLVaLQWFKYz5rpIZCVhxwVosFn5xxnyCM5ZY3nq9Vqn8tSZpU2Bl82ZSw4Dd+Xz2jbOYTqc6ARQCjDwXdoguIheZFPk1bxRANjb9nEOq4hVSGI/yS8ArGIV3X3NY91KQ0+v1tJMYThG8M/ZVz89VvU3ziu43Gg0FsnddB/TvLddd0iAkMiqwZRrqfhzMwz9DToqEOReEFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ダイクストラ例1\"\n        title=\"ダイクストラ例1\"\n        src=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png\"\n        srcset=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/c26ae/dijkstra1.png 158w,\n/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png 309w\"\n        sizes=\"(max-width: 309px) 100vw, 309px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>まずは頂点Aを最小全域木Xとし、その他の頂点をグラフYとする。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 570px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/b42e4c8c4dd3b85059777b6b91fd1cc6/432e7/prim1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.68354430379746%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACLUlEQVQ4y3WU627aQBCF/f4v0Ifoj/6LaKWIIpSmpIrSpoiLMbHxbW0oFdgGjPdyqhm8kXPpSgevV95v5uzM4uCdYYxh0UgmY9z3rmDWGZo0RpMm/1GMcy7gvAa9Bu6WCyyHA9TBE07+EjqJoOOQpdqnlRQJHLuZ1YHS0NpAb3LULajy3AskifhpRHKZt0FaIEGsLrCyLKGUgtYajUhwevJwWC5wXvmQ0YpFoMKdoQmDC5TW04Qsc16tNANd10VVVRxA5gImidjyfj7lzQyMIyxvhpy1SWNAxDB5BsfbKSx2BoudxuyvRlJIKCmfz5KAMgzYogV2bRMcWYrt+BHb+RTOxweBD/05+ilw5TcY/1EwSqIoCoaupxPM+tdszYIoIyoQHQOtIRfwhgP4P0Zw+sERn35v8DWW+OyfMN0qHKsSrrtgYBUGyB7uGUgAm9H68Sf82xue0zoV7rDy4XzLgOtIoh8r9Pwav/Ia0IqLIqVky1SUJlrxRgLbwljLHIgCEnCUawxSjevghC/Bmc+x25cqz/jjI0FtRcmmSBDefUe5mPP7wXNRRyGccVKiqBWqRuMgge2uQCZE24caMhPQVNU0flMQ20p8rrQmUjiborb58O9+v4PneTxvmgZmk/PHupW1STLdILaxu1ete0tsiPVsgtKdsWWSPTsLYr28KS9hz+/Ui+cad70rhKNbbg1blC7szdV794+BJkpBbXKodYazv0TpuZzhi8zeyfAfCQ1uQ7VyOX4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"プリム例1\"\n        title=\"プリム例1\"\n        src=\"/note2-gatsby/static/b42e4c8c4dd3b85059777b6b91fd1cc6/432e7/prim1.png\"\n        srcset=\"/note2-gatsby/static/b42e4c8c4dd3b85059777b6b91fd1cc6/c26ae/prim1.png 158w,\n/note2-gatsby/static/b42e4c8c4dd3b85059777b6b91fd1cc6/6bdcf/prim1.png 315w,\n/note2-gatsby/static/b42e4c8c4dd3b85059777b6b91fd1cc6/432e7/prim1.png 570w\"\n        sizes=\"(max-width: 570px) 100vw, 570px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>次に、グラフXとグラフYを結ぶ辺のうち、Xに加えた時に閉路をなさず、最小コストである辺を探す。この場合は、頂点A-Bを結ぶ辺が該当する。</p>\n<p>この辺、及び、頂点BをXに加え、またYから除外する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 596px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/4cacd41317f07c43f3cf55a951ed054a/699b7/prim2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.31645569620254%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACVElEQVQ4y22TW2/aQBSE+f/v/QOt1McUtVXSNiWkiZQ0Sm9KSCDEN4wNGBwb8A1f1l/lBVITaml0Zte7o5mzuw1qX1mWEv/4en6V5XTcHC8pnv/Va/1r7IpJVltY4iWCVx+vOOguuHYEhRA1sXJPvFHV+qTYciFQ/YyzCTTvfY61iCMj43aaboT2E20E9yNGWcGfmeB0DC0z40PX49jMaRkJhpfsxd0KV5CRRS3iJCw4GSQc3Hl8USPedVw+GxmXwxgvSOSaolj30rIsFovFrsOtmCjh3s05c+BIjXh9oXKohJyOSvRliRACdzYljhPZjmo8sm2CIFjv38xJh6bjcaLMaY/hkxLS7Li0LMHVDJzZgunNL+KBTmqZ5COLYmxLMHPkuKrdb20mvS4NO4I3lzpvf9i0jBXNuyfOp/C1YzFxPVjF9Not/PsOK0OlGA5gbLN46DL4fiF5NtBxfv9krio0Hr1cOmubKW275FhPMJcFC98jTmKKMCDRFDLTYGVoJLqKsIdE6iPzhy7lyCJQ+jCyiC2zilxy6xYcGhnng5DZMt65qHmwJDcNYk2RKCxTonLmd++IlD6paRA9PqwFhSgZ+gmKn5NvTi8MI9I0lbwIAhlzK1S5q2rlzO3cECp9yeUaZ0IjzgrMp3jn6Hu9Hq7rrh0ul5T2UAptUQnmm15KMWuIqOac8cunV+7x2PcI+r3n/lVCeeV2I1xs+LNgffP/Hr6jqVy/b8oN1eGkA33tuIpfh4xcc/hSTD795Zx05hAaGqGuEWgqqTWUd28P9pBs6vAX4w11EUy1rikAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"プリム例2\"\n        title=\"プリム例2\"\n        src=\"/note2-gatsby/static/4cacd41317f07c43f3cf55a951ed054a/699b7/prim2.png\"\n        srcset=\"/note2-gatsby/static/4cacd41317f07c43f3cf55a951ed054a/c26ae/prim2.png 158w,\n/note2-gatsby/static/4cacd41317f07c43f3cf55a951ed054a/6bdcf/prim2.png 315w,\n/note2-gatsby/static/4cacd41317f07c43f3cf55a951ed054a/699b7/prim2.png 596w\"\n        sizes=\"(max-width: 596px) 100vw, 596px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>この動作を繰り返していく。この状態において、グラフXとグラフYを結ぶ辺のうち、Xに加えた時に閉路をなさず、最小コストである辺は、頂点B-Cを結ぶ辺が該当する。よって、頂点CをXに加え、またYから除外する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 599px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/2b6983b2b4e4134c9e3007f9ec340e1f/43142/prim3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.58227848101265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACbUlEQVQ4y4WUaU/iUBSG+f9/wsyHWTJxMos6jrgEFHWcOG6IyFKwlG6AtCwttL29z6RFENFkTnJy7k1znrxvz2kzp6bgyJQUzHiRR4bgrAfvTxus5cvkTWg4EUlIKRc5vy9H5tiMyRmQX8qcITm0YL8VslkZkG1F3HcmbwJXoSkwgRyaksMEZELBIq0b9y7btREHuuTOGietLAtahs+hmYIhnpRJjiz4VnpkqzpM63Z9TF6P+XRpU+uHIOO0aTQaoSjKS3VP0MxZd2YzgSX58bzNl5sOOT3muAOnPXj3W6VoDOd9+L5Pr9tN73EcMx2PnxWu/9XI6ZI9NeDrbY8dxaNgk8ISyz/u+qwXeyhLQ5lHHAb06jVu97IQBCRPMmu5O3bVgI2yw74apNY//Glx0oHvpUc+X+hs1T0q3ckCdHN1xcjQEbrGsFKme3NFaBozyyc2ZNWQ3ZZg5yFkVxNs1jz2NMGBDr8aE7KapGh5EEdM+n2cyj1xu8W0qTBVm4SayrRRRwxcMudtj2vDo2x71J0IdQTNoURxBQ1XpMNIYIbtEFtGCpo0FazrS6TRxlNqePVqCg1dl4zlTpiGIrUiwilD13mxqART6NnItprCEojfVHDKJaTeQmgqUa+LCIPZUJZftDsYUK3WZpzJhMjpI9oaot0i1mc10p7AukZomUS+j3xeTDJvbn4C7Ni4pWJqyW/UmT40U6DQHogMnXA4JF7ZQbmqcBkcdG0ufm5iX1+m6sa1ClGiyukTC/Hqa5mfXwOTGkXEbp+o/0jQqDGuV/FNAxGGC3uroMVisxJzaDqkICDsWES+91/Q/OfwD1v0cI8l0NFqAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"プリム例3\"\n        title=\"プリム例3\"\n        src=\"/note2-gatsby/static/2b6983b2b4e4134c9e3007f9ec340e1f/43142/prim3.png\"\n        srcset=\"/note2-gatsby/static/2b6983b2b4e4134c9e3007f9ec340e1f/c26ae/prim3.png 158w,\n/note2-gatsby/static/2b6983b2b4e4134c9e3007f9ec340e1f/6bdcf/prim3.png 315w,\n/note2-gatsby/static/2b6983b2b4e4134c9e3007f9ec340e1f/43142/prim3.png 599w\"\n        sizes=\"(max-width: 599px) 100vw, 599px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>次は、頂点A-Dを結ぶ辺が該当する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 557px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/7d48e3bf08a643133681eddbfa7936eb/30d00/prim4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.21518987341771%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACcElEQVQ4y22TWU/bQBSF8/srVeoPaNVH2oqKUiCQsAVCAqWIKtAou7M09mSpS0ic2PHY/qqZLASIpevlwd+ce+85sSshSYuICxE+q7QZcG3D260Mm7cmlz3INB3EwwR1RVHEuiuWESEpC85UifnTikhZEeku7JaG7JWHJJo+dx0XGYRL4AK6+h7LikBDzkWkQekOy1LfO8UBx80px+2QfMfRP4Ur6hawRcUyc+AClqy7JIwJR80pX3NdDmpj4pUh28Uh1YcAwgDF830fIcSCOlOogFkRzoBmSLaPbu9jusL3wgOn7YArGxK1MRu3gmLfWyocjUYUCoVn81T3WNr0NfCiy0zVXY+kMSHTU2OAkz+SvdIjm/c25X/yVcuB7yPtPrWf10w6gti77SyHzSnxykjDVOv7VYfDhqcVv08V2bj5w25ljDFc6IBer4c3nRJKybTV4P4gzsioEkuUByTqrh68gihln27a7JYe9btayoE6oCXJd8ZKnwbmcjls2yYKA0ZGDdlq4DTrs6UkGx6HdVcDVZuLDWv7mKE+TNkm3x1rhTIIli1Lz8MxqvgNQ4NjGSvg1Ay1CtWymuOqbVSdtiWJhk918ARyXZd8Pk8YBLhWm3G9xvRvf24bARdzwIezEl9+Ca1WQbVitRyLmW3mW5VS4jiOnmjkuYR2f7bllz78fGtpHyrbfMvb2k7qsBMTqoNQz1C1vDZ6Mx8+JeXcivQiFFg99ysjrTheHrJvuHMfvo7ci6SsZNlCZzhlznK8U3rkzdYlxy3JUTvit3iKXrQmfjrLP4QkIyIU+GVlOxGXXUg1XZLGmIrtPTP2urb/A5dWW87mEfdmAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"プリム例4\"\n        title=\"プリム例4\"\n        src=\"/note2-gatsby/static/7d48e3bf08a643133681eddbfa7936eb/30d00/prim4.png\"\n        srcset=\"/note2-gatsby/static/7d48e3bf08a643133681eddbfa7936eb/c26ae/prim4.png 158w,\n/note2-gatsby/static/7d48e3bf08a643133681eddbfa7936eb/6bdcf/prim4.png 315w,\n/note2-gatsby/static/7d48e3bf08a643133681eddbfa7936eb/30d00/prim4.png 557w\"\n        sizes=\"(max-width: 557px) 100vw, 557px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>次は、頂点D-Eを結ぶ辺が該当する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 589px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/f904b1bc067d666bd6ddd05bc7364151/b1665/prim5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 72.78481012658227%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAACSklEQVQ4y2VUaW/aUBDk/3/tl0qt2rRfqlZKgxLahCOYG7VKiRJoQBCCA9jmMIGQctueavbZARKk1Ts8Ozt7PEI5y0X+heVMB8U+8CbyG5EbG4We9wqzh7c8lKwlGr0nhFImkN4zDynTQ6YHHFVsROpTJO7XSHYcpK0tjhg5W0DSBMr2Bo/zFUL8mLE8ZEhiAdmeMu4jtQnO22sJEmvN5Z57rrm+2tM3aXioPTjgTxH6ZHQ+vf0n6+H1QPbRuzlOahNx1rqO4OL6EsfVsQpsKsKqEHoIqTQ85AdAtDnDx2wDxzcPSHY2KNoQkk+FpmDSfuAf9Sm+lkxRyXO6B1RHPqFmuPKBqr6Xh4i1FnJmdCrh+dulpRx9QgbnSkvoSxwUddTGriKkdKZ1eNUXhyBNEn7I1CUIaxnUj8Y7Kucd8e/SjW3KZ3dzpAxX1DAywSfVsagk+Kw5E2cqpSLuPxdbstKS7TUSHQfXvYVqSlxfCZjOQYdldAxXVgZK3K/EduvI76zzaeMJUX2Fcn+pCFO+U/jvSIqd8msa1ExUdDbP54KtmsJysPsUEm87+10O5uogd4svF10BBfMWFD9Qz2yOWJba5Dm4ZmKH0Nx2jw0KZpGKd9PkPlyxBUPVQRZqDrGvUF6K5SHvg4pD4Gd9ireJinQ43lpIsxiMmKy1fSVZy4NmwH8pHkJ8h5pvnHgaBzVcneB9poGYvsJ515WV9/yu7fjwvyDRBW6CwS4NXVy+sNLAwdUIKI+BX8YCxc4Mf/qbV7jALgYu9EdF+B+ldj2x3EWh2wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"プリム例5\"\n        title=\"プリム例5\"\n        src=\"/note2-gatsby/static/f904b1bc067d666bd6ddd05bc7364151/b1665/prim5.png\"\n        srcset=\"/note2-gatsby/static/f904b1bc067d666bd6ddd05bc7364151/c26ae/prim5.png 158w,\n/note2-gatsby/static/f904b1bc067d666bd6ddd05bc7364151/6bdcf/prim5.png 315w,\n/note2-gatsby/static/f904b1bc067d666bd6ddd05bc7364151/b1665/prim5.png 589w\"\n        sizes=\"(max-width: 589px) 100vw, 589px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>Yの頂点がなくなったので、Xを出力して終了する。このXが、最小全域木である。</p>\n<p>以上が、プリム法による最小全域木の導出である。これをコードで実装した例を以下に示す。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">INF<span class=\"token operator\">=</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"inf\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 設定（ユーザ側で入力）</span>\nV<span class=\"token operator\">=</span><span class=\"token number\">0</span>     <span class=\"token comment\">#頂点数</span>\ncost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>    <span class=\"token comment\">#cost[i][j]:頂点iから頂点jへのコスト</span>\n\n<span class=\"token comment\"># 設定（入力しない）</span>\nans_cost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\">#cost_x[i][j]:(最小全域木の)頂点iから頂点jへのコスト</span>\nmin_cost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>                    <span class=\"token comment\">#min_cost[i]:Xから頂点iへの最小コスト</span>\ny_nearest_x<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>                 <span class=\"token comment\">#y_nearest_x[i]:頂点iへのコストが最も低いXの頂点</span>\nused<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">False</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>                      <span class=\"token comment\">#used[i]:頂点iがXに含まれているか示す</span>\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    ans_cost<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token comment\">#初めの点の初期設定</span>\nmin_cost<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\ny_nearest_x<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n    v<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">1</span>\n    \n    <span class=\"token comment\">#Xに属さない頂点のうちXからの辺のコストが最小になる頂点を探す</span>\n    <span class=\"token keyword\">for</span> u <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">not</span> used<span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> <span class=\"token punctuation\">(</span>v<span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span> <span class=\"token keyword\">or</span> min_cost<span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span> <span class=\"token operator\">&lt;</span> min_cost<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            v<span class=\"token operator\">=</span>u\n\n    <span class=\"token comment\">#全て見終わったら終了</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>v<span class=\"token operator\">==</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">break</span>\n\n    <span class=\"token comment\">#頂点vをXに追加する</span>\n    used<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token boolean\">True</span>\n    ans_cost<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y_nearest_x<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>cost<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>y_nearest_x<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span>\n    ans_cost<span class=\"token punctuation\">[</span>y_nearest_x<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>cost<span class=\"token punctuation\">[</span>y_nearest_x<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span>\n\n    <span class=\"token comment\">#xからの最終コスト更新</span>\n    <span class=\"token keyword\">for</span> u <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>cost<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span><span class=\"token operator\">&lt;</span>min_cost<span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            min_cost<span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>cost<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span>\n            y_nearest_x<span class=\"token punctuation\">[</span>u<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>v\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ans_cost<span class=\"token punctuation\">)</span></code></pre></div>\n<p>このコードにおいて、先程の例で示したグラフを表す以下の値を入力する。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">V<span class=\"token operator\">=</span><span class=\"token number\">5</span>\ncost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>すると、実行結果は以下のようになる。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[0, 2, inf, 6, inf], [2, 0, 1, inf, inf], [inf, 1, 0, inf, inf], [6, inf, inf, 0, 4], [inf, inf, inf, 4, 0]]</code></pre></div>\n<h2>クラスカル法</h2>\n<p>最小全域木を求める2つ目のアルゴリズムとして、クラスカル法を示す。</p>\n<p>クラスカル法は、辺をコストの低い順から、閉路ができないように全ての頂点が含まれるまで追加していくという手法である。この方法で、最小全域木が作成される。</p>\n<p>クラスカル法のアルゴリズムは以下の通り。</p>\n<p>入出力：</p>\n<ul>\n<li>入力</li>\n<li>グラフ G = (V,E)</li>\n<li>W(a,b):頂点aから頂点b(a,b∈V)を結ぶ辺の重み(コスト)。辺が存在しないときはW(a,b)=∞</li>\n<li>出力</li>\n<li>最小全域木 X = (V’,E’)</li>\n</ul>\n<p>アルゴリズム：</p>\n<ol>\n<li>Eをコストの小さい順にソートする。</li>\n<li>コストが最小の辺e (e∈E)を取り出し、eをEから除外する(E=E-e)。</li>\n<li>eをXに追加したときに閉路ができなければ、eをXに追加する。結んでいる頂点もXに追加する。</li>\n<li>Xに全ての頂点が含まれたら、Xを出力して終了する。そうでない時は、2.に戻る。</li>\n</ol>\n<p>3.の閉路ができるかを判定する方法については、Union-FInd木を用いると判定しやすい。辺を追加するときに、結ぶ頂点が同じUnion-Find木にあるならば、閉路ができると判断できる。</p>\n<p>これも図を使って流れを説明してみよう。プリム法でも用いた以下のグラフを利用する。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 309px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABiklEQVQ4y32UWY/CMAyE8/9/FUJ944EXhMoNKvdZzrbi8Oqz5ChbWixFmzTe8czYwUlFfD4feb/fuo+iSOI49t9Z5X0YLgQJE+282+1kPp/L7XaTPM8rc8NvrsysHKfTSdI01f1yuZTn8/mVG+5dmREsHo+HvF4vZbbf7xVwu93K9XqVJEnkcrn4YmaNYXhAu7jf79LpdJQNeyLLMun3+57dZrNR4G63+80wlGesYBMGwKPRyHtIoIKix+NRz6vVSv12zWZTJbCoWhSFsgWcGA6HMhgM9K5cHOZYcjgcpN1uy2QyEUciVfAHZgAiZTweK6PZbKZg7PlHCpPLKLVaLQWFKYz5rpIZCVhxwVosFn5xxnyCM5ZY3nq9Vqn8tSZpU2Bl82ZSw4Dd+Xz2jbOYTqc6ARQCjDwXdoguIheZFPk1bxRANjb9nEOq4hVSGI/yS8ArGIV3X3NY91KQ0+v1tJMYThG8M/ZVz89VvU3ziu43Gg0FsnddB/TvLddd0iAkMiqwZRrqfhzMwz9DToqEOReEFgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ダイクストラ例1\"\n        title=\"ダイクストラ例1\"\n        src=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png\"\n        srcset=\"/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/c26ae/dijkstra1.png 158w,\n/note2-gatsby/static/7818431a13d43c46432fda45aa957eb3/532e8/dijkstra1.png 309w\"\n        sizes=\"(max-width: 309px) 100vw, 309px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>まずは、辺も頂点もない以下の状態から始まる。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/1be83b3210e158718f9e5b8cda55cb5d/42a8d/kruskal1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 76.58227848101265%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABA0lEQVQ4y4VUARKEIAj0/8/10lKxbpZah8jumLFQaVlYLRzO9n0fA/aJ8SjbdtvzvrVggWaAIqJjBjYDD56dn7fWjt67+tLaNObGcMaIILVWfXNNQUXOBL0fpZQH40fJ+CDnPMqEAQB9xJtzJNhMbwdDlqOBIsrKBgyG17rdg88kKSX1Q4xxlAQwGHysMRBMOKexHWzDuq4nIB7MwjLRGzJlz7hPEAAwxrYicMEfDyZ6GzaGIiqg7QUy+tLeDjHmEI/tGSr7wJySKmpV9sbkXsBxsC0De/aqUZYDjNoVM7uuP28KQJdlGWLUFyD7bfh16Qlohfr3kwgzATxbq+zs52B7+AWv+6WUWFm1zgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"クラスカル例1\"\n        title=\"クラスカル例1\"\n        src=\"/note2-gatsby/static/1be83b3210e158718f9e5b8cda55cb5d/42a8d/kruskal1.png\"\n        srcset=\"/note2-gatsby/static/1be83b3210e158718f9e5b8cda55cb5d/c26ae/kruskal1.png 158w,\n/note2-gatsby/static/1be83b3210e158718f9e5b8cda55cb5d/6bdcf/kruskal1.png 315w,\n/note2-gatsby/static/1be83b3210e158718f9e5b8cda55cb5d/42a8d/kruskal1.png 558w\"\n        sizes=\"(max-width: 558px) 100vw, 558px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>次に、一番コストが低い辺を探して、最小全域木に加える。この場合は、頂点B-C間の辺である。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 556px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/76b92e9da93b4d86f64ecead24049403/96638/kruskal2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 73.41772151898735%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABIElEQVQ4y31UWwqEMAzs/a/ggTyEP4IoCvqj1rdmmcBINqsbKK3tZJJJWoM4u65LzvPUdZZlkiSJro/juM/t7C14EAds33dp21ZijDrecJY82Mx8pjAQwaYYZV3XH6z3Cz4SsqJsjG3bpK5rWZZF9ykdsy0DOYKPMs/zTUorikLKstQ1AyEAgnlVwW4QbL8BqqpKuq77qR/PGUAzRF0ohUBKaZpG0jTVmQ4kJZ5lYa0D5QGAQ3zzEPLzPFeHcRx1Zp2HYbgVWfJg0+awd5HNmKZJqIYY63cTcsEo3rCP7PyVQZbYoy9Jv5oCEGU9mb9e+wP26x6CzDfJEz2psZ0Pb2+TWVCOleaJ7PrvW+77Xjtt76QnenzLb4S+g08l8H+bD2fQoP2eS0i8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"クラスカル例2\"\n        title=\"クラスカル例2\"\n        src=\"/note2-gatsby/static/76b92e9da93b4d86f64ecead24049403/96638/kruskal2.png\"\n        srcset=\"/note2-gatsby/static/76b92e9da93b4d86f64ecead24049403/c26ae/kruskal2.png 158w,\n/note2-gatsby/static/76b92e9da93b4d86f64ecead24049403/6bdcf/kruskal2.png 315w,\n/note2-gatsby/static/76b92e9da93b4d86f64ecead24049403/96638/kruskal2.png 556w\"\n        sizes=\"(max-width: 556px) 100vw, 556px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>同様にして、次に最もコストが低い頂点A-B間の辺、さらに次に最もコストが低い頂点D-E間の辺を加える。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 558px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/84b6933d6d9e01116064f4dc507b9143/42a8d/kruskal3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 74.0506329113924%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABdklEQVQ4y32Uya7CMAxF8/8fw4INez4A2MIGMQoh5qEttMXo+MmRXxphqWqaONfX13aDJPb5fPRp21a/e72ezGYzXdue+fCkFjxQzvn5fMrtdpOyLKWqqo6PvxcB002zpmlks9koKHa/3yVnHjykkWBzOp3k8XjIYrFQZtfrVXa7XQxC6vi/Xq9OZpGh6bPf72UymcjxeIx7RVGojrxNS4C9BFHDuq7jB+xWq1V0xDgnVVK3AD5VgLHxeKwkwmAwUACYbbfbP8e2FQs0HA5lOp2qDJ4N54BZdgCez2cJl8slVpA3VhaFvN/vyBqGXEJX04r0TUP29V5ZSiAKCw5x8n1oKXFOAKrtz0wCmHEfYC0Kzlwyx9TsPC3AaDRSbekAyBA8eAfWXGzqujMxaX+i+Xw+j+n+mxTfi2hpbZGbHiq5Xq+1N7ONnY6eX5PGcrlU1hSGlrJqe6BsY+fm+HA4SL/f1xbx1cwBdX4Ov6LClApTyV+zD+AXke+WePmNQ/YAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"クラスカル例3\"\n        title=\"クラスカル例3\"\n        src=\"/note2-gatsby/static/84b6933d6d9e01116064f4dc507b9143/42a8d/kruskal3.png\"\n        srcset=\"/note2-gatsby/static/84b6933d6d9e01116064f4dc507b9143/c26ae/kruskal3.png 158w,\n/note2-gatsby/static/84b6933d6d9e01116064f4dc507b9143/6bdcf/kruskal3.png 315w,\n/note2-gatsby/static/84b6933d6d9e01116064f4dc507b9143/42a8d/kruskal3.png 558w\"\n        sizes=\"(max-width: 558px) 100vw, 558px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>次だが、最もコストの低い頂点A-C間の辺は加えると閉路ができてしまうので、ここでは加えない。その次にコストの低い頂点A-D間の辺を加える。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 560px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/9031f184e5163e23c575802dae061346/b06ae/kruskal4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 75.9493670886076%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsTAAALEwEAmpwYAAABgElEQVQ4y4WU246CQAyG5/0fyCsvfQC9UNQLY4yCgod4AgWkm6/ZknFgs00mDj3+7d/Rya80TdP+2kGm06nEcSxFUUhd170+/t2JJ6b05fl8ajJsj8ej4xfGuLBCWZZ6kP1+L0mSyO12k+v1qvrP59P6cw8RO3MwI4Gz2UwTcUder5csl8s2mNY5RZ53OnKhgnltNpu2AEJwFEVSVVWbFDt6Q5amqX670Wikc8rzXLbbrbbnz2Y8Hst6vZbD4dAhz7p7v98yGAx01m4+n2sSOwgGmyNFsizTgrRuyQABIpJyxx+7towzBhJJ00hVlq0zwThyh2V/hgh64m0LlBSyH49H2e12X7Oz+VAIFFbAiFqtVkoccdiZ8RcpBBrD/hL37RwAJpOJXC6XL70Ltx4nCIDt0+nUWQvaAhEJw0ehexg+IV8gY7FYyP1+V/QgZ9mNsL4n2Hkp/pKDYjgcaluM4Hw+dxCFQNxffw4I+8UqQQAI+Q59/30pfQSAzpKFRcOEPzNylQQfouLIAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"クラスカル例4\"\n        title=\"クラスカル例4\"\n        src=\"/note2-gatsby/static/9031f184e5163e23c575802dae061346/b06ae/kruskal4.png\"\n        srcset=\"/note2-gatsby/static/9031f184e5163e23c575802dae061346/c26ae/kruskal4.png 158w,\n/note2-gatsby/static/9031f184e5163e23c575802dae061346/6bdcf/kruskal4.png 315w,\n/note2-gatsby/static/9031f184e5163e23c575802dae061346/b06ae/kruskal4.png 560w\"\n        sizes=\"(max-width: 560px) 100vw, 560px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>これで、全ての頂点が含まれたので、このグラフを出力して終了する。このグラフが、最小全域木となる。</p>\n<p>では次に、コードでの実装例を以下に示す。(なお、コード中で使用しているUnion-Find木のスクリプトは<a href=\"https://github.com/WAT36/python/blob/master/procon/union_find.py\">こちら</a>を参照。)</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> union_find <span class=\"token keyword\">import</span> UnionFind_fast\n\nINF<span class=\"token operator\">=</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"inf\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#辺</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">edge</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>start<span class=\"token punctuation\">,</span>end<span class=\"token punctuation\">,</span>cost<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        self<span class=\"token punctuation\">.</span>start<span class=\"token operator\">=</span>start\n        self<span class=\"token punctuation\">.</span>end<span class=\"token operator\">=</span>end\n        self<span class=\"token punctuation\">.</span>cost<span class=\"token operator\">=</span>cost\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">e_comp</span><span class=\"token punctuation\">(</span>e1<span class=\"token punctuation\">,</span>e2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">return</span> e1<span class=\"token punctuation\">.</span>cost <span class=\"token operator\">&lt;</span> e2<span class=\"token punctuation\">.</span>cost\n\n\n<span class=\"token comment\"># 設定（ユーザ側で入力）</span>\nV<span class=\"token operator\">=</span><span class=\"token number\">0</span>     <span class=\"token comment\">#頂点数</span>\ncost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>    <span class=\"token comment\">#cost[i][j]:頂点iから頂点jへのコスト</span>\n\n<span class=\"token comment\"># 設定（入力しない）</span>\nes<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>edge<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">,</span>j<span class=\"token punctuation\">,</span>cost<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span> <span class=\"token keyword\">for</span> j <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>i<span class=\"token operator\">+</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>V<span class=\"token punctuation\">)</span> <span class=\"token keyword\">if</span> cost<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span> <span class=\"token operator\">!=</span> INF <span class=\"token punctuation\">]</span>\nes<span class=\"token operator\">=</span><span class=\"token builtin\">sorted</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">,</span>key<span class=\"token operator\">=</span><span class=\"token keyword\">lambda</span> ei<span class=\"token punctuation\">:</span>ei<span class=\"token punctuation\">.</span>cost<span class=\"token punctuation\">)</span>\nans_cost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span>INF <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>  <span class=\"token comment\">#cost_x[i][j]:(最小全域木の)頂点iから頂点jへのコスト</span>\nuf<span class=\"token operator\">=</span>UnionFind_fast<span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>es<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    ei<span class=\"token operator\">=</span>es<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">not</span> uf<span class=\"token punctuation\">.</span>same<span class=\"token punctuation\">(</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">,</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        uf<span class=\"token punctuation\">.</span>unite<span class=\"token punctuation\">(</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">,</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">)</span>\n        ans_cost<span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>cost<span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">]</span>\n        ans_cost<span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span>cost<span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>end<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>ei<span class=\"token punctuation\">.</span>start<span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ans_cost<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>ここで、プリム法と同じく以下の設定値を入力して実行してみる。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">V<span class=\"token operator\">=</span><span class=\"token number\">5</span>\ncost<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span><span class=\"token number\">6</span><span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span><span class=\"token punctuation\">[</span>INF<span class=\"token punctuation\">,</span><span class=\"token number\">9</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>実行結果は以下の通り。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">[[inf, 2, inf, 6, inf], [2, inf, 1, inf, inf], [inf, 1, inf, inf, inf], [6, inf, inf, inf, 4], [inf, inf, inf, 4, inf]]</code></pre></div>","frontmatter":{"title":"最小全域木","date":"November 02, 2019","description":"","tags":[]}}},"pageContext":{"id":"984400b7-d43d-5e15-b378-656efcc3aee5"}},"staticQueryHashes":["2841359383","3257411868"]}