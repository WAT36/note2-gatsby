{"componentChunkName":"component---src-templates-note-js","path":"/programming/013_procon/003_graph/network_flow/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"105811b9-0d0e-58f8-b88e-d699e34e166f","excerpt":"ネットワークフロー グラフにおける最大流・最小流問題についてを述べる。 以下に例題を示す。  まずは、貪欲法を用いて流せるところに目一杯データを流すという方法が考えられる。以下のアルゴリズムを考える。 流れているデータ量が最大に達していない辺のみを用いたsからt…","html":"<h1>ネットワークフロー</h1>\n<p>グラフにおける最大流・最小流問題についてを述べる。</p>\n<p>以下に例題を示す。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">\nネットワーク上の2台のコンピュータS,Tがあり、SからTにデータを送りたいとする。\nこのネットワークには全部でN台のコンピュータがあり、いくつかのコンピュータの間は一方向性の通信ケーブルで接続されていて、\nそれぞれ１秒間に通信できる最大のデータ量が決まっています。他のコンピュータが通信を行なっていない時、\nsからtへどれだけのデータを送信することができるでしょうか。\n</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/a0209/networkflow1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.06329113924051%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABvUlEQVQoz21TacuBQRSd//8bpJR8QJZCD7JkCZEn+xLigy37ki0cnVsjvO/Uzcw8c88959xLAcDz+cTj8cD9fucRp9MJwWAQ2WwW6XQaoVAIzWYTLpcLXq8X5XIZtVoN0WgUmUwGiUQCsVhMMBTBftfxeES1WpUCt9sNrVYLnU5HolQqoV6vC8DhcEC/35c3xWIR5/MZigC9Xk+q5HI5ecBEv98vDHnv8XiwXC6/ipKlYRiigEypiATUfr+HaZpCPRKJIJ/PY7FYSNJ2u4XT6ZQIBAIYDofvewZXpVKB1WqFz+eTfJVMJkUCQdvttvzqRS/J7Hq9goXJgLLm8zm0VdxT+uVykTeKdKfTqYBOJhOkUinoRtHL3W73JfX3TDW6mVyKAAz6FY/HxfTP5mw2m/e52+2K+YPB4M2SgFTAPUOaQllsAtkSfDwe/wFcrVYYjUagRRwjXZi5n5OiODtsO71hMr2gBUwsFArSeY7IbDb7ksoCVMVvJMGuC+B/c8hm0FMmUVKj0RB/1+u1BJmzIL+zON/TCpJRugH638JFNjabDeFwWGbN4XDIWPHOYrGI1/zmdrtlz3Gx2+3i5Qvo5h4ZmI+gswAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ネットワークフロー\"\n        title=\"ネットワークフロー\"\n        src=\"/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/f058b/networkflow1.png\"\n        srcset=\"/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/c26ae/networkflow1.png 158w,\n/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/6bdcf/networkflow1.png 315w,\n/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/f058b/networkflow1.png 630w,\n/note2-gatsby/static/25441f665780162d72a0a541cb13a91f/a0209/networkflow1.png 725w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>まずは、貪欲法を用いて流せるところに目一杯データを流すという方法が考えられる。以下のアルゴリズムを考える。</p>\n<ol>\n<li>流れているデータ量が最大に達していない辺のみを用いたsからtへのパスを見つける</li>\n<li>そのようなパスが存在しなければ終了。存在すれば、そのパスに沿って目一杯流し、1.へ戻る</li>\n</ol>\n<p>このアルゴリズムで試した場合、以下のような流れになる。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/00b70/networkflow2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.69620253164557%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB10lEQVQoz21TaY+iQBT0//+O3Q9eOyaeIxIvlOCgRgFvF40yKN66E29r894GVrNbSYem6a6uV6/wPR4P0Ljf77jdbiDM53OUy2V0u100Gg2e93o9BAIBxONxtFotXq9Wq/xsNps8J/jwH0wmEyY7nU7Y7feoqio+bRuDwQC6rqPdbqNQKGC9XmM4HOJ4PEKSpD+EX3oDTU1DIpFAOp1GrVbj24RMBrJUhJhM4MfbG2zbxuVy8S4l1fl8HtlslpV7hKahe5JlWYaqqnwj4WvhoJtOIvn+jlAohGg0itVqxcrO5zPvyeVy8Pv9iMViqNfr8MmKgn6/zyXSIK9cHA6/sN3vX+xYLpfY7XY8v16vWCwWPHd74YtEIl6ZxWIRlUrlifDgHSaQcvLVBTXRcRyPkEvudDpQFIX9IKMNw3gh3G633mG6lDwjAZZl8fo/CullNpshlUpxU0qlEjfALW+z2XBptEZqiIwEjEYjjtp0OvXUMaGbvWfZtJnMpgbR4Ywo4vK0j+BGhyqjPZqm/c2hG2wabg6pOZ+Whbnj4EOWYZs/oRsGyKLxeAxRFFk9KSdriPiFkOASmqaJYDAIQRA4MpHv3zCW8kgJAsLhMP8t9J2yS55SnFzC38i0HyWS7LVKAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ネットワークフロー\"\n        title=\"ネットワークフロー\"\n        src=\"/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/f058b/networkflow2.png\"\n        srcset=\"/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/c26ae/networkflow2.png 158w,\n/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/6bdcf/networkflow2.png 315w,\n/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/f058b/networkflow2.png 630w,\n/note2-gatsby/static/c0b00d2849fbf2156579b7186b8d7ee3/00b70/networkflow2.png 733w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/167b5/networkflow3.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 51.89873417721519%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB30lEQVQoz21SaW/aUBD0//8P/RApCkVIpmmVFhDlCHd9cxgD5ZADxmASgbiED6bajbAatSM9W/ab3Z2dXQH/wXw+R7PZxGw6hWkNoD59Re3Hd3y6u8OXdBppUcRoNEKv14NpmtB1nePCMIQQrl28rVawX14wnU6x3++haRoqz8+Y2TZMy0Kj0UAQBHxHp16vQ1UUdE0Tvb4FSZJiMULQ1fG73Uat0UA+n0ehUGB1qmFAKv7Et4d7iI+PrHaz2XDQYj6HpCjQqxU8fX5AIpnEeDyG67oQBpMJfkkSS1dVFYvFIq52XDpYDizImoZyuYx+v4/tdovT8cj3B9eBM+hDVjVUq1XOIRi6juVyye3S27Ksdz+CACvP++Ct7/vY7Xbxvff6+o//QrFY5DZbrRarGA6HscGe5yEI/Hc1hwMXvVwuuF6vCKOILQh8n7lRFPERiOw4DjKZDEqlEhRFYSWE9Xr9YfK5XA6pVAqVSoWDaUA3UBFWSI/T6QTbtlkdtU0Gt9ttGIaBTqfD3twCCJSI/lFXxKNit6TC38QbZrMZD4j8pH2TFQXn85n9o/WhJJPJhHlUnLiEuGVKSh/kBYGmSX52u12ecDWVhFws4D6RQDabhSiKkGWZi9FS12q1WOEfLwHZiehKr1UAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ネットワークフロー\"\n        title=\"ネットワークフロー\"\n        src=\"/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/f058b/networkflow3.png\"\n        srcset=\"/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/c26ae/networkflow3.png 158w,\n/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/6bdcf/networkflow3.png 315w,\n/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/f058b/networkflow3.png 630w,\n/note2-gatsby/static/58043256aa83b4a6dcd3a74694589978/167b5/networkflow3.png 776w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>これが最適なのか？というと、実はもっと最適な方法があり、以下の通りである。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/96e92/networkflow4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.53164556962025%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAB8ElEQVQoz11TDY/hUBTt//8ZkpWMNWKJpqoYX0XZHVrxWYs1hGJa4ps6m3t3K8NNXt7ruzfn3nPeqYD/cbvdeF0uF+RyOaiqikqlgnw+j1E6wbssy9B1nc/ZbJbzqVQKRqPBGK7rQnCvVwahDwo6G4bB4BTr9RqaJKL2/s6NyuUyotEoDocDlsslNpsNut0u116vVwjrbgs5VUUsFoOiKNw5GAxCkiQosgy/34/eYICvUSqV8BoKIa0oeP0eQFyW7zmh32nDNPtoGAbTGY1GPK3tOBgmZUTCYW4QiUQwHA6x2+3gODaOrovZTw3qjxC+vbwgHA4jkUhAqOs6Wq0W6vU6qtXqvRNRsj8/mfrxeGQgom9Z1l3z5WKBy/nMVClPS+iZJgOapskaebHdbuE4zgNVuvOCQEjD5xAKb29Qi0V+OU3TcD6fObHf73kiL3q9HmvXbrcxmUz+yWLbeHaJYP/uQ5QkiKLIGnQ6HS5YrVaYTqdctLAsjMdjFItFZDIZNJtNbkh6kxwPgGQTWjTZ6XRiG6TTaRQKhTvAn4+PB1oETv4jryaTSW5w9+GzBtS5VquxfvP5nB9Br1Ywm80wGAyYJoHRTjWUb3w1tjeqZ2R6XfIkTUa6xuNx/Ar4+c7n87GpA4EAe5Y0pb+H2Hi0/wLrXSA1wGRUzAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ネットワークフロー\"\n        title=\"ネットワークフロー\"\n        src=\"/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/f058b/networkflow4.png\"\n        srcset=\"/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/c26ae/networkflow4.png 158w,\n/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/6bdcf/networkflow4.png 315w,\n/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/f058b/networkflow4.png 630w,\n/note2-gatsby/static/4054f6a32f1060ed7f24a816b13a0f72/96e92/networkflow4.png 779w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>最初の貪欲法では最適解を導けないという事だろうか。</p>\n<p>ここで、最適解と貪欲法で導いた解との、各辺におけるフローの差をとると以下の通りになる。</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/62de4/networkflow5.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.16455696202532%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAABqElEQVQoz3VTx6oCQRDc//8E8ehJBRUTqJgwZw8iBlARs2DOoR5VvF3khYZhhume2qrqXgPf8X6/8Xq9dB4OhwiFQqhUKshms4hEIpjP53A4HHC73ajX68olk0nkcjkUCgWUSiW9NQhkrufzqcter4dOp4PL5YLdbod0Oo3lcolut4tms4lWq4VEIoH9fq/z4/EQqADxR+TzeXg8HjEgO5fLJfDPiMfjUsE9EAioToCUMh6PMZlMtBaLBU6nk5Jkx1w4HBYo5dOW1WqF2+2mms1mI9bMs84g1UajYfkyGAwsFiw+HA6y4nw+C2S73eqeQXAS4H69XkXEqNVqYkEgekT/PgEJZAYfkZ3ZRC4CfoaRSqXARaaxWAz9ft9Kko0pn8bTnp9TwWaZbHmnplSrVfj9foGORiMcj0cVsdhkOJ1Ocb/frcdm8P7zIwb9YSG9YhMY7XZb3WO3OWfRaPRXlzlWVEZVbBbf/Ds2HGx6Sn8ou1gsaifj9XqN2WyGTCYj9iZDqvx3sMvlMux2O4LBILxeL2w2mxTQRzaGkp1Op/4ajorP59OZgF9zaCmhNOtlqAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"ネットワークフロー\"\n        title=\"ネットワークフロー\"\n        src=\"/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/f058b/networkflow5.png\"\n        srcset=\"/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/c26ae/networkflow5.png 158w,\n/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/6bdcf/networkflow5.png 315w,\n/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/f058b/networkflow5.png 630w,\n/note2-gatsby/static/fc3ed2d1a2eea01ab49d3ac06bee3fd5/62de4/networkflow5.png 746w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>この図から、最適解は貪欲法で求めた解から更に一部のフローを押し戻す(図中の-1の辺)形で、新たにフローを足していると見ることができる。</p>\n<p>ここで、先程のアルゴリズムを改良し、以下のように考えてみよう。</p>\n<ol>\n<li>流れているデータ量が最大に達していない辺、またはすでにデータが流れている辺の逆辺を用いたsからtへのパスを見つける</li>\n<li>そのようなパスが存在しなければ終了。存在すれば、そのパスに沿って目一杯流し、1.へ戻る</li>\n</ol>\n<p>これを最初の貪欲法で求めた状態から適用すると、s→2→1→3→tと大きさ1のフローを流せば最適解になる。(2→1は逆辺)</p>\n<p>このアルゴリズムをコードで実装した例を以下に記載する。</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">INF<span class=\"token operator\">=</span><span class=\"token builtin\">float</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"inf\"</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">edge</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">def</span> <span class=\"token function\">__init__</span><span class=\"token punctuation\">(</span>self<span class=\"token punctuation\">,</span>to<span class=\"token punctuation\">,</span>cap<span class=\"token punctuation\">,</span>rev<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            self<span class=\"token punctuation\">.</span>to<span class=\"token operator\">=</span>to\n            self<span class=\"token punctuation\">.</span>cap<span class=\"token operator\">=</span>cap\n            self<span class=\"token punctuation\">.</span>rev<span class=\"token operator\">=</span>rev\n\n<span class=\"token comment\">#頂点の数</span>\nV<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n\n<span class=\"token comment\">#グラフ</span>\nG<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n<span class=\"token comment\">#DFSですでに使われたかのフラグ</span>\nused<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#初期化</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">init</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> G\n    <span class=\"token keyword\">global</span> used\n    G<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    used<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">False</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">#fromからtoへ向かう容量capの辺をグラフに追加する</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">add_edge</span><span class=\"token punctuation\">(</span>from_v<span class=\"token punctuation\">,</span>to_v<span class=\"token punctuation\">,</span>cap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> G\n    <span class=\"token comment\">#from->toの容量capの辺,逆辺はto->fromの辺</span>\n    G<span class=\"token punctuation\">[</span>from_v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>edge<span class=\"token punctuation\">(</span>to_v<span class=\"token punctuation\">,</span>cap<span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">[</span>to_v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    G<span class=\"token punctuation\">[</span>to_v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>append<span class=\"token punctuation\">(</span>edge<span class=\"token punctuation\">(</span>from_v<span class=\"token punctuation\">,</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">[</span>from_v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">#増加パスをDFSで探す</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">dfs</span><span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span>f<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> G\n    <span class=\"token keyword\">global</span> used\n    <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>v<span class=\"token operator\">==</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span> f\n    used<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token operator\">=</span><span class=\"token boolean\">True</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>G<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        e<span class=\"token operator\">=</span>G<span class=\"token punctuation\">[</span>v<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">not</span> used<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">]</span> <span class=\"token keyword\">and</span> e<span class=\"token punctuation\">.</span>cap <span class=\"token operator\">></span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            d <span class=\"token operator\">=</span> dfs<span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span><span class=\"token builtin\">min</span><span class=\"token punctuation\">(</span>f<span class=\"token punctuation\">,</span>e<span class=\"token punctuation\">.</span>cap<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n            <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>d<span class=\"token operator\">></span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                e<span class=\"token punctuation\">.</span>cap<span class=\"token operator\">-=</span>d\n                G<span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>to<span class=\"token punctuation\">]</span><span class=\"token punctuation\">[</span>e<span class=\"token punctuation\">.</span>rev<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>cap<span class=\"token operator\">+=</span>d\n                <span class=\"token keyword\">return</span> d\n    <span class=\"token keyword\">return</span> <span class=\"token number\">0</span>\n\n<span class=\"token comment\">#sからtへの最大流を求める</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">max_flow</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> used\n    flow<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n    <span class=\"token keyword\">while</span> <span class=\"token boolean\">True</span><span class=\"token punctuation\">:</span>\n        used<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span><span class=\"token boolean\">False</span> <span class=\"token keyword\">for</span> _ <span class=\"token keyword\">in</span> <span class=\"token builtin\">range</span><span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n        f<span class=\"token operator\">=</span>dfs<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span>t<span class=\"token punctuation\">,</span>INF<span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">if</span><span class=\"token punctuation\">(</span>f<span class=\"token operator\">==</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">return</span> flow\n        flow<span class=\"token operator\">+=</span>f\n\n<span class=\"token comment\">#初期化</span>\nV<span class=\"token operator\">=</span><span class=\"token number\">5</span>\ninit<span class=\"token punctuation\">(</span>V<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#入力(辺)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">10</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">6</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\nadd_edge<span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">8</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">#実行</span>\nans<span class=\"token operator\">=</span>max_flow<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>ans<span class=\"token punctuation\">)</span></code></pre></div>\n<p>実行結果</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">11</code></pre></div>\n<p>となり、最適解が求められる。</p>","frontmatter":{"title":"ネットワークフロー","date":"November 02, 2019","description":"","tags":[]}}},"pageContext":{"id":"105811b9-0d0e-58f8-b88e-d699e34e166f"}},"staticQueryHashes":["2841359383","3257411868"]}