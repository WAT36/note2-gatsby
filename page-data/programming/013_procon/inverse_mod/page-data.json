{"componentChunkName":"component---src-templates-note-js","path":"/programming/013_procon/inverse_mod/","result":{"data":{"site":{"siteMetadata":{"title":"WAT Note(II)"}},"markdownRemark":{"id":"22d18f0e-504c-5276-8e69-c4a1f1a09d28","excerpt":"最近知ったのだが、今は高校数学の課程に合同式が入っているそうだ。 自分はゆとり世代ゆえ正式には学んでない（予備校で少し出てきたことはあったが曖昧）ので、改めて学び直してみた。 同時に、競プロに関係する事項も。 合同式(mod) 合同式とは以下の定義。 a,bを整数、mを自然数とした時、 「aをmで割った余り」と「bをm…","html":"<p>最近知ったのだが、今は高校数学の課程に合同式が入っているそうだ。</p>\n<p>自分はゆとり世代ゆえ正式には学んでない（予備校で少し出てきたことはあったが曖昧）ので、改めて学び直してみた。</p>\n<p>同時に、競プロに関係する事項も。</p>\n<h2>合同式(mod)</h2>\n<p>合同式とは以下の定義。</p>\n<hr>\n<p>a,bを整数、mを自然数とした時、</p>\n<p>「aをmで割った余り」と「bをmで割った余り」が等しいことを以下の式で表す。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{1}\na  \\equiv b \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>この式を<strong>合同式</strong>という。</p>\n<hr>\n<p>プログラムで表現するなら</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">a%m == b%m</code></pre></div>\n<p>である。</p>\n<h2>合同式の定理</h2>\n<p>合同式には定理がいくつかある。</p>\n<h3>合同式の和</h3>\n<p>整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{2}\na+c  \\equiv b+d \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<h3>合同式の差</h3>\n<p>同様に、整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{3}\na-c  \\equiv b-d \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<h3>合同式の積</h3>\n<p>同様に、整数a,b,c,d、自然数mにおいて　a≡b (mod m) ,c≡d (mod m) の時、以下の式が成立する。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{4}\nac  \\equiv bd \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>以上の式より、</p>\n<p>{{&#x3C; katex  >}}\n\\tag{5}\na+c  \\equiv b+c \\pmod{m} \\\na-c  \\equiv b-c \\pmod{m} \\\nac  \\equiv bc \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>も成立し、これらの式から、合同式は移項・乗法も可能である。</p>\n<h3>合同式のべき乗</h3>\n<p>整数a,b、自然数mにおいて　a≡b (mod m) の時、以下の式が成立する。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{6}\na^n  \\equiv b^n \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<h4>(証明)</h4>\n<p>整数a,b,c,dを、自然数mと整数p,q,r,s,t,uを用い、以下のように定義する。</p>\n<p>{{&#x3C; katex  >}}\na = pm + t \\\nb = qm + t \\\nc = rm + u \\\nd = sm + u\n{{&#x3C; /katex >}}</p>\n<p>この時、</p>\n<p>{{&#x3C; katex  >}}\na  \\equiv b \\pmod{m} \\\nc  \\equiv d \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>であり、また</p>\n<p>{{&#x3C; katex  >}}\n\\begin{aligned}\na+c  &#x26;= (p+r)m + (t+u) \\\nb+d  &#x26;= (q+s)m + (t+u) \\\na-c  &#x26;= (p-r)m + (t-u) \\\nb-d  &#x26;= (q-s)m + (t-u) \\\nac   &#x26;= (prm + pu+tr)m + tu \\\nbd   &#x26;= (qsm + qu+st)m + tu \\\na^n  &#x26;= (p^{n} m^{n-1} + {}_n \\mathrm{C} _1 p^{n-1} m^{n-2} t + \\cdots + {}_n \\mathrm{C} _{n-1} p t^{n-1})m + t^n \\\nb^n  &#x26;= (q^{n} m^{n-1} + {}_n \\mathrm{C} _1 p^{n-1} m^{n-2} t + \\cdots + {}_n \\mathrm{C} _{n-1} p t^{n-1})m + t^n\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>である。これらより、</p>\n<p>{{&#x3C; katex  >}}\n\\begin{aligned}\na+c  &#x26; \\equiv b+d &#x26; \\pmod{m} \\\na-c  &#x26; \\equiv b-d &#x26; \\pmod{m} \\\nac   &#x26; \\equiv bd  &#x26; \\pmod{m} \\\na^n  &#x26; \\equiv b^n &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>が成立する。</p>\n<h3>合同式の除法</h3>\n<p>整数a,b,c、 自然数mにおいて　ab≡ac (mod m) の時でかつ<strong>aとmが互いに素</strong>の時、以下の式が成立する。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{7}\n\\begin{aligned}\nab  &#x26; \\equiv ac &#x26; \\pmod{m} \\\n\\Leftrightarrow　b  &#x26; \\equiv c &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<h4>(証明)</h4>\n<p>ab≡ac (mod m)　、かつaとmが互いに素の時において</p>\n<p>{{&#x3C; katex  >}}\n\\tag{8}\n\\begin{aligned}\nab  &#x26; \\equiv ac &#x26; \\pmod{m} \\\n\\Leftrightarrow　ab-ac   &#x26; \\equiv 0 &#x26; \\pmod{m} \\\n\\Leftrightarrow　a(b-c)  &#x26; \\equiv 0 &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>となり、この式において、a(b-c)と0はmで割った余りが同じであり、0をmで割った余りは0なので、a(b-c)をmで割った余りも0、つまりa(b-c)はmで割り切れる(=mの倍数)ということになる。</p>\n<p>aとmは互いに素なので、b-cがmの倍数という事になる。</p>\n<p>これより、(b-c)≡0 (mod m)が成立するので、</p>\n<p>{{&#x3C; katex  >}}\n\\tag{9}\n\\begin{aligned}\n(b-c)  &#x26; \\equiv 0 &#x26; \\pmod{m} \\\n\\Leftrightarrow　b   &#x26; \\equiv c &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>となり、aとmが互いに素でab≡ac (mod m)の時、b≡c (mod m)が成立する。</p>\n<p>ちなみに、aとmが互いに素ではない時、(b-c)がmの倍数でない場合があるため、これは成立しない。</p>\n<hr>\n<p>以上が、合同式についての定義及び定理の紹介である。</p>\n<p>これらを踏まえ、次に逆元についてを述べる。</p>\n<h2>逆元</h2>\n<p>modを使った方程式を解いてみることを考える。例えばa,bを整数、mを自然数とした、以下のような式があったとする。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{10}\nax  \\equiv b \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>この式でxを求めるにはどのようにすれば良いのだろうか。</p>\n<p>この時、</p>\n<p>{{&#x3C; katex  >}}\n\\tag{11}\nay \\equiv 1 \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>となるような整数yが存在した場合、合同式の積の定理から、</p>\n<p>{{&#x3C; katex  >}}\n\\tag{12}\n\\begin{aligned}\nx &#x26; \\equiv x &#x26; \\pmod{m} \\\n\\Leftrightarrow 1 \\cdot x &#x26; \\equiv ay \\cdot x &#x26; \\pmod{m} \\\n\\Leftrightarrow x &#x26; \\equiv y \\cdot ax &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>{{&#x3C; katex  >}}\n\\tag{13}\n\\begin{aligned}\nax &#x26; \\equiv b &#x26; \\pmod{m} \\\n\\Leftrightarrow y \\cdot ax &#x26; \\equiv y \\cdot b &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>が成り立つ。これより、</p>\n<p>{{&#x3C; katex  >}}\n\\tag{14}\n\\begin{aligned}\nx &#x26; \\equiv y \\cdot ax &#x26; \\pmod{m} \\\n&#x26; \\equiv y \\cdot b &#x26; \\pmod{m}\n\\end{aligned}\n{{&#x3C; /katex >}}</p>\n<p>と求めることができる。</p>\n<p>このように、a,mに対して</p>\n<p>{{&#x3C; katex  >}}\n\\tag{15}\nay \\equiv 1 \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>となるような整数yのことを、aの<strong>逆元</strong>といい、大体はa<sup>-1</sup>と書く。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{16}\na \\cdot a^{-1} \\equiv 1 \\pmod{m}\n{{&#x3C; /katex >}}</p>\n<p>また、式(10)において、a,mが互いに素でない場合以下のように書き換えることもできる。</p>\n<p>{{&#x3C; katex  >}}\n\\tag{17}\n\\frac{ax}{gcd(a,m)}  \\equiv \\frac{b}{gcd(a,m)} \\pmod{ \\frac{m}{gcd(a,m)} }\n{{&#x3C; /katex >}}</p>\n<p>ここで、gcd(a,m)はaとmの最大公約数である。</p>\n<p>式(14),(16),(17)より、式(10)の解は</p>\n<p>{{&#x3C; katex  >}}\n\\tag{18}\nx  =  \\left(\\frac{a}{gcd(a,m)}\\right)^{-1} \\cdot \\frac{b}{gcd(a,m)} +  k \\cdot \\frac{m}{gcd(a,m)} \\pmod{ m }\n{{&#x3C; /katex >}}</p>\n<p>となる。ただしkは0 ≦ k ≦ gcd(a,m)を満たす整数である。</p>\n<h2>フェルマーの小定理</h2>\n<p>pが素数の時、任意の整数xに対して</p>\n<p>{{&#x3C; katex  >}}\n\\tag{19}\nx^p  \\equiv x \\pmod{p}\n{{&#x3C; /katex >}}</p>\n<p>が成り立つ。</p>\n<p>特にxがpで割り切れない場合(互いに素)の時は、合同式の除法より</p>\n<p>{{&#x3C; katex  >}}\n\\tag{20}\nx^{p-1}  \\equiv 1 \\pmod{p}\n{{&#x3C; /katex >}}</p>\n<p>が成り立つ。</p>\n<p>式(20)より</p>\n<p>{{&#x3C; katex  >}}\n\\tag{21}\nx \\cdot x^{p-2}  \\equiv 1 \\pmod{p}\n{{&#x3C; /katex >}}</p>\n<p>となるので、pが素数の時、整数xの逆元はx<sup>p-2</sup>であることもわかる。</p>\n<!--\n## オイラーの定理\n\nフェルマーの小定理はpが素数の時のみ使える定理であった。pが素数でない(合成数)時はどのようにすれば良いのだろうか。\n\n実はpが素数でない時は、**オイラーの定理**という定理が適用できる。\n\n合成数pを\n\n{{< katex  >}}\n\\tag{22}\np = p_{1}^{e_{1}} p_{2}^{e_{2}} \\cdots p_{n}^{e_{n}}\n{{< /katex >}}\n\nと表した時、オイラー関数φ(p)を以下のように定義する。\n\n{{< katex  >}}\n\\tag{23}\n\\phi(p) = p \\prod_{i=1}^n \\frac{p_{i}-1}{p_{i}}\n{{< /katex >}}\n\n式(23)は、実はp以下のpと互いに素な自然数の個数と等しくなる。\n\nまたこの時、pと互いに素な整数xについて、以下の式も成り立つ。\n\n{{< katex  >}}\n\\tag{24}\nx^{\\phi(p)}  \\equiv 1 \\pmod{p}\n{{< /katex >}}\n-->","frontmatter":{"title":"合同式(mod)・逆元","date":"November 03, 2019","description":"","tags":[]}}},"pageContext":{"id":"22d18f0e-504c-5276-8e69-c4a1f1a09d28"}},"staticQueryHashes":["2841359383","3257411868"]}